var fs = require('fs'),
    url = require('url'),
    querystring = require('querystring');

exports.writeBlog = function(req, res){
	/*var retHtml = fs.readFileSync(BASE_DIR + '/static/html/index.html');
	console.log("index has already returned!");

	res.writeHead(200, {'Content-Type' : 'text/html'});
    res.write(retHtml);
    res.end();*/

    var params = {
        "account" : 0,
        "photo" : "",
        "nickName" : ""
    };

    var queryStr = url.parse(req.url).query,
        queryParam = querystring.parse(queryStr);
    console.log(queryParam);

    var usersStr = fs.readFileSync(BASE_DIR + '/static/data/user.json');
    var users = JSON.parse(usersStr);
    var mark = false;

    for(var x in users.users){
        if(users.users[x].account == queryParam.loginaccount*1){
            mark = true;
            params.account = users.users[x].account;
            params.photo = users.users[x].photo;
            params.nickName = users.users[x].nickName;

            break;
        }
    }

    if(!mark){
        console.log("can not find this user!");
        return;
    }

    console.log("writeBlog has already returned!");
    res.render(BASE_DIR + '/static/template/writeBlog.jade', {"params" : params});

};