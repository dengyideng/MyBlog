var fs = require('fs'),
    url = require('url'),
    querystring = require('querystring');

exports.userMessage = function(req, res){

    var queryStr = url.parse(req.url).query,
        queryParam = querystring.parse(queryStr);
    console.log(queryParam);

    var usersStr = fs.readFileSync(BASE_DIR + '/static/data/user.json');
    var users = JSON.parse(usersStr);
    var mark = false;

    var params = {
        "account" : 0,
        "nickName" : "",
        "name" : "",
        "photo" : "",
        "sex" : "",
        "birthday" : "",
        "password" : "",
        "career" : "",
        "job" : "",
        "region" : "",
        "introduction" : "",
        "statusCode" : 0,
        "province" : "",
        "city" : "",
        "area" : ""
    };
    //0: do nothing, 1: success, 2: fail

    for(var x in users.users){
        if(users.users[x].account == queryParam.loginaccount){
            mark = true;
            params.account = users.users[x].account;
            params.nickName = users.users[x].nickName;
            params.name = users.users[x].name;
            params.photo = users.users[x].photo;
            params.sex = users.users[x].sex;
            params.birthday = users.users[x].birthday;
            params.password = users.users[x].password;
            params.career = users.users[x].career;
            params.job = users.users[x].job;
            params.region = users.users[x].region;
            params.introduction = users.users[x].introduction;

            params.province = users.users[x].province;
            params.city = users.users[x].city;
            params.area = users.users[x].area;

            console.log("userMessage has already returned!");
            //console.log(params);
            res.render(BASE_DIR + '/static/template/userMessage.jade', {"params" : params});

            break;
        }
    }

    if(!mark){
        console.log("can not find this user!");
        return;
    }

}